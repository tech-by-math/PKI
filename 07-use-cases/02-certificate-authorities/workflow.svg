<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceGraphic" stdDeviation="3"/>
      <feOffset dx="2" dy="2" result="offset"/>
    </filter>
    <pattern id="diagonalHatch" patternUnits="userSpaceOnUse" width="4" height="4">
      <path d="M0,4 L4,0" stroke="#ccc" stroke-width="1"/>
    </pattern>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="700" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-family="Arial, sans-serif" 
        font-size="24" font-weight="bold" fill="#2c3e50">
    Certificate Authority Hierarchy and Operations
  </text>
  
  <!-- Root CA Level -->
  <g transform="translate(50, 70)">
    <rect x="350" y="0" width="200" height="80" rx="15" fill="#fff3e0" 
          stroke="#ff6f00" stroke-width="3" filter="url(#shadow)"/>
    <text x="450" y="25" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="16" font-weight="bold" fill="#ff6f00">ROOT CA</text>
    <text x="450" y="45" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" fill="#333">Self-Signed Certificate</text>
    <text x="450" y="60" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" fill="#333">HSM Protected Key</text>
    <text x="450" y="75" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" fill="#333">20-Year Validity</text>
    
    <!-- Trust Anchor Symbol -->
    <circle cx="450" cy="100" r="15" fill="#ff6f00" stroke="#fff" stroke-width="2"/>
    <text x="450" y="106" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="14" font-weight="bold" fill="#fff">T</text>
  </g>
  
  <!-- Intermediate CA Level -->
  <g transform="translate(50, 200)">
    <!-- Employee Certificates CA -->
    <rect x="50" y="0" width="180" height="70" rx="10" fill="#e8f5e8" 
          stroke="#4caf50" stroke-width="2" filter="url(#shadow)"/>
    <text x="140" y="20" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="14" font-weight="bold" fill="#4caf50">Employee CA</text>
    <text x="140" y="38" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">User Certificates</text>
    <text x="140" y="52" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">S/MIME, Auth</text>
    <text x="140" y="66" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">3-Year Validity</text>
    
    <!-- Server Certificates CA -->
    <rect x="270" y="0" width="180" height="70" rx="10" fill="#e3f2fd" 
          stroke="#2196f3" stroke-width="2" filter="url(#shadow)"/>
    <text x="360" y="20" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="14" font-weight="bold" fill="#2196f3">Server CA</text>
    <text x="360" y="38" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">TLS Certificates</text>
    <text x="360" y="52" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">HTTPS, mTLS</text>
    <text x="360" y="66" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">2-Year Validity</text>
    
    <!-- Code Signing CA -->
    <rect x="490" y="0" width="180" height="70" rx="10" fill="#fce4ec" 
          stroke="#e91e63" stroke-width="2" filter="url(#shadow)"/>
    <text x="580" y="20" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="14" font-weight="bold" fill="#e91e63">Code Sign CA</text>
    <text x="580" y="38" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">Software Signing</text>
    <text x="580" y="52" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">Timestamping</text>
    <text x="580" y="66" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">3-Year Validity</text>
    
    <!-- OCSP Responder CA -->
    <rect x="720" y="0" width="130" height="70" rx="10" fill="#f3e5f5" 
          stroke="#9c27b0" stroke-width="2" filter="url(#shadow)"/>
    <text x="785" y="20" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="14" font-weight="bold" fill="#9c27b0">OCSP CA</text>
    <text x="785" y="38" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">Status Checking</text>
    <text x="785" y="52" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">Real-time</text>
    <text x="785" y="66" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="11" fill="#333">1-Year Validity</text>
  </g>
  
  <!-- End Entity Certificates Level -->
  <g transform="translate(50, 320)">
    <!-- User Certificates -->
    <rect x="20" y="0" width="100" height="50" rx="8" fill="#e8f5e8" 
          stroke="#4caf50" stroke-width="1"/>
    <text x="70" y="18" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" font-weight="bold" fill="#4caf50">Alice Cert</text>
    <text x="70" y="32" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">Email + Auth</text>
    <text x="70" y="44" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">1 Year</text>
    
    <rect x="140" y="0" width="100" height="50" rx="8" fill="#e8f5e8" 
          stroke="#4caf50" stroke-width="1"/>
    <text x="190" y="18" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" font-weight="bold" fill="#4caf50">Bob Cert</text>
    <text x="190" y="32" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">S/MIME</text>
    <text x="190" y="44" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">1 Year</text>
    
    <!-- Server Certificates -->
    <rect x="280" y="0" width="100" height="50" rx="8" fill="#e3f2fd" 
          stroke="#2196f3" stroke-width="1"/>
    <text x="330" y="18" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" font-weight="bold" fill="#2196f3">web.corp.com</text>
    <text x="330" y="32" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">TLS Server</text>
    <text x="330" y="44" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">90 Days</text>
    
    <rect x="400" y="0" width="100" height="50" rx="8" fill="#e3f2fd" 
          stroke="#2196f3" stroke-width="1"/>
    <text x="450" y="18" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" font-weight="bold" fill="#2196f3">api.corp.com</text>
    <text x="450" y="32" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">API Gateway</text>
    <text x="450" y="44" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">90 Days</text>
    
    <!-- Code Signing Certificates -->
    <rect x="520" y="0" width="100" height="50" rx="8" fill="#fce4ec" 
          stroke="#e91e63" stroke-width="1"/>
    <text x="570" y="18" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" font-weight="bold" fill="#e91e63">Dev Team</text>
    <text x="570" y="32" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">Code Signing</text>
    <text x="570" y="44" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">2 Years</text>
    
    <rect x="640" y="0" width="100" height="50" rx="8" fill="#fce4ec" 
          stroke="#e91e63" stroke-width="1"/>
    <text x="690" y="18" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" font-weight="bold" fill="#e91e63">Release</text>
    <text x="690" y="32" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">Timestamping</text>
    <text x="690" y="44" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">3 Years</text>
    
    <!-- OCSP Responder -->
    <rect x="760" y="0" width="90" height="50" rx="8" fill="#f3e5f5" 
          stroke="#9c27b0" stroke-width="1"/>
    <text x="805" y="18" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" font-weight="bold" fill="#9c27b0">OCSP Service</text>
    <text x="805" y="32" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">Status Check</text>
    <text x="805" y="44" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="9" fill="#333">Real-time</text>
  </g>
  
  <!-- Trust Chain Arrows -->
  <!-- Root to Intermediates -->
  <line x1="450" y1="170" x2="190" y2="200" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="450" y1="170" x2="410" y2="200" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="450" y1="170" x2="630" y2="200" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <line x1="500" y1="170" x2="835" y2="200" stroke="#333" stroke-width="2" 
        marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  
  <!-- Intermediates to End Entities -->
  <line x1="140" y1="270" x2="120" y2="320" stroke="#4caf50" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <line x1="140" y1="270" x2="240" y2="320" stroke="#4caf50" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  
  <line x1="360" y1="270" x2="380" y2="320" stroke="#2196f3" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <line x1="360" y1="270" x2="500" y2="320" stroke="#2196f3" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  
  <line x1="580" y1="270" x2="620" y2="320" stroke="#e91e63" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  <line x1="580" y1="270" x2="740" y2="320" stroke="#e91e63" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  
  <line x1="785" y1="270" x2="805" y2="320" stroke="#9c27b0" stroke-width="2" 
        marker-end="url(#arrowhead)"/>
  
  <!-- Operations Flow -->
  <g transform="translate(50, 420)">
    <rect x="0" y="0" width="800" height="160" rx="12" fill="#f5f5f5" 
          stroke="#666" stroke-width="2" stroke-dasharray="10,5"/>
    <text x="400" y="25" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="18" font-weight="bold" fill="#333">CA Operational Workflow</text>
    
    <!-- Key Ceremony -->
    <rect x="20" y="40" width="120" height="60" rx="8" fill="#fff3e0" 
          stroke="#ff8f00" stroke-width="2"/>
    <text x="80" y="58" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#ff8f00">Key Ceremony</text>
    <text x="80" y="74" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">M-of-N Auth</text>
    <text x="80" y="88" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">HSM Generation</text>
    
    <!-- Certificate Issuance -->
    <rect x="160" y="40" width="120" height="60" rx="8" fill="#e8f5e8" 
          stroke="#4caf50" stroke-width="2"/>
    <text x="220" y="58" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#4caf50">Issuance</text>
    <text x="220" y="74" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">CSR Processing</text>
    <text x="220" y="88" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">Identity Verify</text>
    
    <!-- CRL Management -->
    <rect x="300" y="40" width="120" height="60" rx="8" fill="#ffebee" 
          stroke="#f44336" stroke-width="2"/>
    <text x="360" y="58" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#f44336">CRL</text>
    <text x="360" y="74" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">Revocation List</text>
    <text x="360" y="88" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">30-day Updates</text>
    
    <!-- OCSP Services -->
    <rect x="440" y="40" width="120" height="60" rx="8" fill="#f3e5f5" 
          stroke="#9c27b0" stroke-width="2"/>
    <text x="500" y="58" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#9c27b0">OCSP</text>
    <text x="500" y="74" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">Real-time Status</text>
    <text x="500" y="88" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">Response Signing</text>
    
    <!-- Audit & Compliance -->
    <rect x="580" y="40" width="120" height="60" rx="8" fill="#e0f2f1" 
          stroke="#00695c" stroke-width="2"/>
    <text x="640" y="58" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="12" font-weight="bold" fill="#00695c">Audit</text>
    <text x="640" y="74" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">Compliance Log</text>
    <text x="640" y="88" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="10" fill="#333">WebTrust</text>
    
    <!-- Workflow arrows -->
    <line x1="140" y1="70" x2="160" y2="70" stroke="#333" stroke-width="2" 
          marker-end="url(#arrowhead)"/>
    <line x1="280" y1="70" x2="300" y2="70" stroke="#333" stroke-width="2" 
          marker-end="url(#arrowhead)"/>
    <line x1="420" y1="70" x2="440" y2="70" stroke="#333" stroke-width="2" 
          marker-end="url(#arrowhead)"/>
    <line x1="560" y1="70" x2="580" y2="70" stroke="#333" stroke-width="2" 
          marker-end="url(#arrowhead)"/>
    
    <!-- Performance Metrics -->
    <g transform="translate(0, 120)">
      <text x="20" y="15" font-family="Arial, sans-serif" font-size="12" 
            font-weight="bold" fill="#666">Performance:</text>
      <text x="110" y="15" font-family="Arial, sans-serif" font-size="11" fill="#333">
        Certificate Issuance: 1000/min | OCSP Response: &lt;3ms | Chain Validation: 2-5ms
      </text>
      <text x="20" y="32" font-family="Arial, sans-serif" font-size="12" 
            font-weight="bold" fill="#666">Security:</text>
      <text x="80" y="32" font-family="Arial, sans-serif" font-size="11" fill="#333">
        FIPS 140-2 Level 3+ HSM | Multi-person Controls | Comprehensive Audit Logging
      </text>
    </g>
  </g>
  
  <!-- Mathematical Foundation -->
  <g transform="translate(50, 600)">
    <rect x="0" y="0" width="800" height="80" rx="8" fill="#f8f9fa" 
          stroke="#495057" stroke-width="2"/>
    <text x="400" y="25" text-anchor="middle" font-family="Arial, sans-serif" 
          font-size="14" font-weight="bold" fill="#495057">Mathematical Trust Model</text>
    <text x="20" y="45" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Trust Chain: Root_cert → Intermediate_cert → End_entity_cert (each signature verifiable)
    </text>
    <text x="20" y="60" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Validation: Verify(Cert_signature, CA_public_key) ∧ ValidityPeriod(Cert) ∧ ¬Revoked(Cert)
    </text>
  </g>
</svg>